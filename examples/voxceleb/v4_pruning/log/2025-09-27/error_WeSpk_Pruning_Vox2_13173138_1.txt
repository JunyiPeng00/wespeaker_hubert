
Lmod is automatically replacing "craype-x86-rome" with "craype-x86-trento".

-------------------------------------------------------------------------------
There are messages associated with the following module(s):
-------------------------------------------------------------------------------

PyTorch/2.2.2-rocm-5.6.1-python-3.10-singularity-20240617:
   Though this container is based on a version of ROCm that is officially
   supported by the ROCm driver on the system, we cannot exclude that there
   will be problems when, e.g., the container integrates with the Cray PE as
   it may be trying to link to libraries that were meant to be used with a
   different version of ROCm. In particular, we expect that mpi4py may
   produce warnings.

-------------------------------------------------------------------------------

/opt/miniconda3/envs/pytorch/lib/python3.10/site-packages/torch/distributed/launch.py:183: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use-env is set by default in torchrun.
If your script expects `--local-rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
/user-software/venv/pytorch/lib/python3.10/site-packages/kaldiio/__init__.py:2: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
/user-software/venv/pytorch/lib/python3.10/site-packages/kaldiio/__init__.py:2: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
/user-software/venv/pytorch/lib/python3.10/site-packages/kaldiio/__init__.py:2: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
/user-software/venv/pytorch/lib/python3.10/site-packages/kaldiio/__init__.py:2: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
/user-software/venv/pytorch/lib/python3.10/site-packages/kaldiio/__init__.py:2: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
/user-software/venv/pytorch/lib/python3.10/site-packages/kaldiio/__init__.py:2: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
/user-software/venv/pytorch/lib/python3.10/site-packages/kaldiio/__init__.py:2: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
/user-software/venv/pytorch/lib/python3.10/site-packages/kaldiio/__init__.py:2: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
ESPnet is not installed, cannot use espnet_hubert upstream
ESPnet is not installed, cannot use espnet_hubert upstream
ESPnet is not installed, cannot use espnet_hubert upstream
ESPnet is not installed, cannot use espnet_hubert upstream
ESPnet is not installed, cannot use espnet_hubert upstream
ESPnet is not installed, cannot use espnet_hubert upstream
ESPnet is not installed, cannot use espnet_hubert upstream
ESPnet is not installed, cannot use espnet_hubert upstream
[ INFO : 2025-09-27 21:37:21,385 ] - training on multiple gpus, this gpu 7
[ INFO : 2025-09-27 21:37:21,385 ] - training on multiple gpus, this gpu 3
[ INFO : 2025-09-27 21:37:21,385 ] - training on multiple gpus, this gpu 0
[ INFO : 2025-09-27 21:37:21,385 ] - training on multiple gpus, this gpu 2
[ INFO : 2025-09-27 21:37:21,385 ] - training on multiple gpus, this gpu 1
[ INFO : 2025-09-27 21:37:21,385 ] - training on multiple gpus, this gpu 6
[ INFO : 2025-09-27 21:37:21,385 ] - training on multiple gpus, this gpu 4
[ INFO : 2025-09-27 21:37:21,385 ] - training on multiple gpus, this gpu 5
[ INFO : 2025-09-27 21:37:21,397 ] - exp_dir is: exp/baseline_vox2/mhfa_WavLMBasePlus_frozen
[ INFO : 2025-09-27 21:37:21,397 ] - <== Passed Arguments ==>
[ INFO : 2025-09-27 21:37:21,399 ] - {'data_type': 'raw',
[ INFO : 2025-09-27 21:37:21,399 ] -  'dataloader_args': {'batch_size': 256,
[ INFO : 2025-09-27 21:37:21,399 ] -                      'drop_last': True,
[ INFO : 2025-09-27 21:37:21,399 ] -                      'num_workers': 1,
[ INFO : 2025-09-27 21:37:21,399 ] -                      'pin_memory': False,
[ INFO : 2025-09-27 21:37:21,399 ] -                      'prefetch_factor': 2},
[ INFO : 2025-09-27 21:37:21,399 ] -  'dataset_args': {'aug_prob': 0.6,
[ INFO : 2025-09-27 21:37:21,399 ] -                   'cmvn': True,
[ INFO : 2025-09-27 21:37:21,399 ] -                   'cmvn_args': {'norm_mean': True, 'norm_var': False},
[ INFO : 2025-09-27 21:37:21,399 ] -                   'filter': True,
[ INFO : 2025-09-27 21:37:21,399 ] -                   'filter_args': {'max_num_frames': 400, 'min_num_frames': 50},
[ INFO : 2025-09-27 21:37:21,399 ] -                   'frontend': 'huggingface',
[ INFO : 2025-09-27 21:37:21,399 ] -                   'huggingface_args': {'frame_length': 20,
[ INFO : 2025-09-27 21:37:21,400 ] -                                        'frame_shift': 20,
[ INFO : 2025-09-27 21:37:21,400 ] -                                        'frozen': True,
[ INFO : 2025-09-27 21:37:21,400 ] -                                        'upstream_args': {'name': 'wavlm_base_plus',
[ INFO : 2025-09-27 21:37:21,400 ] -                                                          'path_or_url': './convert/',
[ INFO : 2025-09-27 21:37:21,400 ] -                                                          'pruning_units': ''}},
[ INFO : 2025-09-27 21:37:21,400 ] -                   'num_frms': 150,
[ INFO : 2025-09-27 21:37:21,400 ] -                   'resample_rate': 16000,
[ INFO : 2025-09-27 21:37:21,400 ] -                   'sample_num_per_epoch': 0,
[ INFO : 2025-09-27 21:37:21,400 ] -                   'shuffle': True,
[ INFO : 2025-09-27 21:37:21,400 ] -                   'shuffle_args': {'shuffle_size': 2500},
[ INFO : 2025-09-27 21:37:21,400 ] -                   'spec_aug': False,
[ INFO : 2025-09-27 21:37:21,400 ] -                   'spec_aug_args': {'max_f': 8,
[ INFO : 2025-09-27 21:37:21,400 ] -                                     'max_t': 10,
[ INFO : 2025-09-27 21:37:21,400 ] -                                     'num_f_mask': 1,
[ INFO : 2025-09-27 21:37:21,400 ] -                                     'num_t_mask': 1,
[ INFO : 2025-09-27 21:37:21,400 ] -                                     'prob': 0.6},
[ INFO : 2025-09-27 21:37:21,400 ] -                   'speed_perturb': True},
[ INFO : 2025-09-27 21:37:21,401 ] -  'do_lm': False,
[ INFO : 2025-09-27 21:37:21,401 ] -  'enable_amp': True,
[ INFO : 2025-09-27 21:37:21,401 ] -  'exp_dir': 'exp/baseline_vox2/mhfa_WavLMBasePlus_frozen',
[ INFO : 2025-09-27 21:37:21,401 ] -  'gpus': [0, 1, 2, 3, 4, 5, 6, 7],
[ INFO : 2025-09-27 21:37:21,401 ] -  'local_rank': 0,
[ INFO : 2025-09-27 21:37:21,401 ] -  'log_batch_interval': 100,
[ INFO : 2025-09-27 21:37:21,401 ] -  'loss': 'CrossEntropyLoss',
[ INFO : 2025-09-27 21:37:21,401 ] -  'loss_args': {},
[ INFO : 2025-09-27 21:37:21,401 ] -  'margin_scheduler': 'MarginScheduler',
[ INFO : 2025-09-27 21:37:21,401 ] -  'margin_update': {'final_margin': 0.2,
[ INFO : 2025-09-27 21:37:21,401 ] -                    'fix_start_epoch': 10,
[ INFO : 2025-09-27 21:37:21,401 ] -                    'increase_start_epoch': 3,
[ INFO : 2025-09-27 21:37:21,401 ] -                    'increase_type': 'exp',
[ INFO : 2025-09-27 21:37:21,401 ] -                    'initial_margin': 0.0,
[ INFO : 2025-09-27 21:37:21,401 ] -                    'update_margin': True},
[ INFO : 2025-09-27 21:37:21,401 ] -  'model': 'SSL_BACKEND_MHFA',
[ INFO : 2025-09-27 21:37:21,402 ] -  'model_args': {'compression_dim': 128,
[ INFO : 2025-09-27 21:37:21,402 ] -                 'embed_dim': 256,
[ INFO : 2025-09-27 21:37:21,402 ] -                 'feat_dim': -1,
[ INFO : 2025-09-27 21:37:21,402 ] -                 'feature_grad_mult': 0.0,
[ INFO : 2025-09-27 21:37:21,402 ] -                 'head_nb': 32,
[ INFO : 2025-09-27 21:37:21,402 ] -                 'nb_layer': 13},
[ INFO : 2025-09-27 21:37:21,402 ] -  'model_init': None,
[ INFO : 2025-09-27 21:37:21,402 ] -  'noise_data': 'data/musan/lmdb',
[ INFO : 2025-09-27 21:37:21,402 ] -  'num_avg': 3,
[ INFO : 2025-09-27 21:37:21,402 ] -  'num_epochs': 15,
[ INFO : 2025-09-27 21:37:21,402 ] -  'optimizer': 'SGD',
[ INFO : 2025-09-27 21:37:21,402 ] -  'optimizer_args': {'momentum': 0.9, 'nesterov': True, 'weight_decay': 1e-07},
[ INFO : 2025-09-27 21:37:21,402 ] -  'projection_args': {'easy_margin': False,
[ INFO : 2025-09-27 21:37:21,402 ] -                      'project_type': 'arc_margin_intertopk_subcenter',
[ INFO : 2025-09-27 21:37:21,402 ] -                      'scale': 32.0},
[ INFO : 2025-09-27 21:37:21,402 ] -  'reverb_data': 'data/rirs/lmdb',
[ INFO : 2025-09-27 21:37:21,402 ] -  'save_epoch_interval': 1,
[ INFO : 2025-09-27 21:37:21,403 ] -  'scheduler': 'ExponentialDecrease',
[ INFO : 2025-09-27 21:37:21,403 ] -  'scheduler_args': {'final_lr': 0.005,
[ INFO : 2025-09-27 21:37:21,403 ] -                     'initial_lr': 0.1,
[ INFO : 2025-09-27 21:37:21,403 ] -                     'warm_from_zero': True,
[ INFO : 2025-09-27 21:37:21,403 ] -                     'warm_up_epoch': 3},
[ INFO : 2025-09-27 21:37:21,403 ] -  'seed': 42,
[ INFO : 2025-09-27 21:37:21,403 ] -  'train_data': 'data/vox2_dev/raw.list',
[ INFO : 2025-09-27 21:37:21,403 ] -  'train_label': 'data/vox2_dev/utt2spk',
[ INFO : 2025-09-27 21:37:21,403 ] -  'train_lmdb': 'data/vox2_dev/lmdb'}
[ INFO : 2025-09-27 21:37:24,544 ] - <== Model ==>
[ INFO : 2025-09-27 21:37:24,852 ] - <== Data statistics ==>
[ INFO : 2025-09-27 21:37:24,853 ] - train data num: 1092009, spk num: 5994
[ INFO : 2025-09-27 21:37:25,189 ] - <== Dataloaders ==>
[ INFO : 2025-09-27 21:37:25,189 ] - train dataloaders created
[ INFO : 2025-09-27 21:37:25,190 ] - epoch iteration number: 533
[ INFO : 2025-09-27 21:37:25,190 ] - <== Model ==>
[ INFO : 2025-09-27 21:37:25,203 ] - <== Model ==>
[ INFO : 2025-09-27 21:37:25,203 ] - <== Model ==>
[ INFO : 2025-09-27 21:37:25,222 ] - <== Model ==>
[ INFO : 2025-09-27 21:37:25,223 ] - <== Model ==>
[ INFO : 2025-09-27 21:37:25,572 ] - <== Model ==>
[ INFO : 2025-09-27 21:37:25,697 ] - <== Model ==>
Some weights of the model checkpoint at microsoft/wavlm-base-plus were not used when initializing WavLMModel: ['encoder.pos_conv_embed.conv.weight_g', 'encoder.pos_conv_embed.conv.weight_v']
- This IS expected if you are initializing WavLMModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing WavLMModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of the model checkpoint at microsoft/wavlm-base-plus were not used when initializing WavLMModel: ['encoder.pos_conv_embed.conv.weight_g', 'encoder.pos_conv_embed.conv.weight_v']
- This IS expected if you are initializing WavLMModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing WavLMModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of the model checkpoint at microsoft/wavlm-base-plus were not used when initializing WavLMModel: ['encoder.pos_conv_embed.conv.weight_g', 'encoder.pos_conv_embed.conv.weight_v']
- This IS expected if you are initializing WavLMModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing WavLMModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of the model checkpoint at microsoft/wavlm-base-plus were not used when initializing WavLMModel: ['encoder.pos_conv_embed.conv.weight_g', 'encoder.pos_conv_embed.conv.weight_v']
- This IS expected if you are initializing WavLMModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing WavLMModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of the model checkpoint at microsoft/wavlm-base-plus were not used when initializing WavLMModel: ['encoder.pos_conv_embed.conv.weight_g', 'encoder.pos_conv_embed.conv.weight_v']
- This IS expected if you are initializing WavLMModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing WavLMModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of the model checkpoint at microsoft/wavlm-base-plus were not used when initializing WavLMModel: ['encoder.pos_conv_embed.conv.weight_g', 'encoder.pos_conv_embed.conv.weight_v']
- This IS expected if you are initializing WavLMModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing WavLMModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of the model checkpoint at microsoft/wavlm-base-plus were not used when initializing WavLMModel: ['encoder.pos_conv_embed.conv.weight_g', 'encoder.pos_conv_embed.conv.weight_v']
- This IS expected if you are initializing WavLMModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing WavLMModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of the model checkpoint at microsoft/wavlm-base-plus were not used when initializing WavLMModel: ['encoder.pos_conv_embed.conv.weight_g', 'encoder.pos_conv_embed.conv.weight_v']
- This IS expected if you are initializing WavLMModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing WavLMModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of WavLMModel were not initialized from the model checkpoint at microsoft/wavlm-base-plus and are newly initialized: ['encoder.pos_conv_embed.conv.parametrizations.weight.original0', 'encoder.pos_conv_embed.conv.parametrizations.weight.original1']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Some weights of WavLMModel were not initialized from the model checkpoint at microsoft/wavlm-base-plus and are newly initialized: ['encoder.pos_conv_embed.conv.parametrizations.weight.original0', 'encoder.pos_conv_embed.conv.parametrizations.weight.original1']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Some weights of WavLMModel were not initialized from the model checkpoint at microsoft/wavlm-base-plus and are newly initialized: ['encoder.pos_conv_embed.conv.parametrizations.weight.original0', 'encoder.pos_conv_embed.conv.parametrizations.weight.original1']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Some weights of WavLMModel were not initialized from the model checkpoint at microsoft/wavlm-base-plus and are newly initialized: ['encoder.pos_conv_embed.conv.parametrizations.weight.original0', 'encoder.pos_conv_embed.conv.parametrizations.weight.original1']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Some weights of WavLMModel were not initialized from the model checkpoint at microsoft/wavlm-base-plus and are newly initialized: ['encoder.pos_conv_embed.conv.parametrizations.weight.original0', 'encoder.pos_conv_embed.conv.parametrizations.weight.original1']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Some weights of WavLMModel were not initialized from the model checkpoint at microsoft/wavlm-base-plus and are newly initialized: ['encoder.pos_conv_embed.conv.parametrizations.weight.original0', 'encoder.pos_conv_embed.conv.parametrizations.weight.original1']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Some weights of WavLMModel were not initialized from the model checkpoint at microsoft/wavlm-base-plus and are newly initialized: ['encoder.pos_conv_embed.conv.parametrizations.weight.original0', 'encoder.pos_conv_embed.conv.parametrizations.weight.original1']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Some weights of WavLMModel were not initialized from the model checkpoint at microsoft/wavlm-base-plus and are newly initialized: ['encoder.pos_conv_embed.conv.parametrizations.weight.original0', 'encoder.pos_conv_embed.conv.parametrizations.weight.original1']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[ INFO : 2025-09-27 21:37:29,507 ] - Importing model.
[ INFO : 2025-09-27 21:37:29,508 ] - Loading model configuration.
[ DEBUG : 2025-09-27 21:37:29,508 ] -   - config: {'extractor_mode': 'group_norm', 'extractor_conv_layer_config': [(512, 10, 5), (512, 3, 2), (512, 3, 2), (512, 3, 2), (512, 3, 2), (512, 2, 2), (512, 2, 2)], 'extractor_conv_bias': False, 'encoder_embed_dim': 768, 'encoder_projection_dropout': 0.1, 'encoder_pos_conv_kernel': 128, 'encoder_pos_conv_groups': 16, 'encoder_num_layers': 12, 'encoder_use_attention': [True, True, True, True, True, True, True, True, True, True, True, True], 'encoder_use_feed_forward': [True, True, True, True, True, True, True, True, True, True, True, True], 'encoder_total_num_heads': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'encoder_remaining_heads': [[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]], 'encoder_num_buckets': 320, 'encoder_max_distance': 800, 'encoder_attention_dropout': 0.1, 'encoder_ff_interm_features': [3072, 3072, 3072, 3072, 3072, 3072, 3072, 3072, 3072, 3072, 3072, 3072], 'encoder_ff_interm_dropout': 0.0, 'encoder_dropout': 0.1, 'encoder_layer_norm_first': False, 'encoder_layer_drop': 0.05, 'normalize_waveform': False}
[ INFO : 2025-09-27 21:37:29,508 ] - Building model.
[ WARNING : 2025-09-27 21:37:29,508 ] - The model is not an instance of Wav2Vec2ForCTC or WavLMForCTC. "lm_head" module is not imported.
[ INFO : 2025-09-27 21:37:29,520 ] - Importing model.
[ INFO : 2025-09-27 21:37:29,520 ] - Loading model configuration.
[ INFO : 2025-09-27 21:37:29,520 ] - Importing model.
[ INFO : 2025-09-27 21:37:29,520 ] - Loading model configuration.
[ DEBUG : 2025-09-27 21:37:29,520 ] -   - config: {'extractor_mode': 'group_norm', 'extractor_conv_layer_config': [(512, 10, 5), (512, 3, 2), (512, 3, 2), (512, 3, 2), (512, 3, 2), (512, 2, 2), (512, 2, 2)], 'extractor_conv_bias': False, 'encoder_embed_dim': 768, 'encoder_projection_dropout': 0.1, 'encoder_pos_conv_kernel': 128, 'encoder_pos_conv_groups': 16, 'encoder_num_layers': 12, 'encoder_use_attention': [True, True, True, True, True, True, True, True, True, True, True, True], 'encoder_use_feed_forward': [True, True, True, True, True, True, True, True, True, True, True, True], 'encoder_total_num_heads': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'encoder_remaining_heads': [[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]], 'encoder_num_buckets': 320, 'encoder_max_distance': 800, 'encoder_attention_dropout': 0.1, 'encoder_ff_interm_features': [3072, 3072, 3072, 3072, 3072, 3072, 3072, 3072, 3072, 3072, 3072, 3072], 'encoder_ff_interm_dropout': 0.0, 'encoder_dropout': 0.1, 'encoder_layer_norm_first': False, 'encoder_layer_drop': 0.05, 'normalize_waveform': False}
[ INFO : 2025-09-27 21:37:29,520 ] - Building model.
[ INFO : 2025-09-27 21:37:29,520 ] - Importing model.
[ INFO : 2025-09-27 21:37:29,520 ] - Importing model.
[ INFO : 2025-09-27 21:37:29,520 ] - Importing model.
[ INFO : 2025-09-27 21:37:29,520 ] - Importing model.
[ WARNING : 2025-09-27 21:37:29,520 ] - The model is not an instance of Wav2Vec2ForCTC or WavLMForCTC. "lm_head" module is not imported.
[ INFO : 2025-09-27 21:37:29,520 ] - Importing model.
[ DEBUG : 2025-09-27 21:37:29,520 ] -   - config: {'extractor_mode': 'group_norm', 'extractor_conv_layer_config': [(512, 10, 5), (512, 3, 2), (512, 3, 2), (512, 3, 2), (512, 3, 2), (512, 2, 2), (512, 2, 2)], 'extractor_conv_bias': False, 'encoder_embed_dim': 768, 'encoder_projection_dropout': 0.1, 'encoder_pos_conv_kernel': 128, 'encoder_pos_conv_groups': 16, 'encoder_num_layers': 12, 'encoder_use_attention': [True, True, True, True, True, True, True, True, True, True, True, True], 'encoder_use_feed_forward': [True, True, True, True, True, True, True, True, True, True, True, True], 'encoder_total_num_heads': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'encoder_remaining_heads': [[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]], 'encoder_num_buckets': 320, 'encoder_max_distance': 800, 'encoder_attention_dropout': 0.1, 'encoder_ff_interm_features': [3072, 3072, 3072, 3072, 3072, 3072, 3072, 3072, 3072, 3072, 3072, 3072], 'encoder_ff_interm_dropout': 0.0, 'encoder_dropout': 0.1, 'encoder_layer_norm_first': False, 'encoder_layer_drop': 0.05, 'normalize_waveform': False}
[ INFO : 2025-09-27 21:37:29,520 ] - Loading model configuration.
[ INFO : 2025-09-27 21:37:29,520 ] - Loading model configuration.
[ INFO : 2025-09-27 21:37:29,520 ] - Loading model configuration.
[ INFO : 2025-09-27 21:37:29,520 ] - Loading model configuration.
[ INFO : 2025-09-27 21:37:29,520 ] - Loading model configuration.
[ INFO : 2025-09-27 21:37:29,521 ] - Building model.
[ WARNING : 2025-09-27 21:37:29,521 ] - The model is not an instance of Wav2Vec2ForCTC or WavLMForCTC. "lm_head" module is not imported.
[ DEBUG : 2025-09-27 21:37:29,521 ] -   - config: {'extractor_mode': 'group_norm', 'extractor_conv_layer_config': [(512, 10, 5), (512, 3, 2), (512, 3, 2), (512, 3, 2), (512, 3, 2), (512, 2, 2), (512, 2, 2)], 'extractor_conv_bias': False, 'encoder_embed_dim': 768, 'encoder_projection_dropout': 0.1, 'encoder_pos_conv_kernel': 128, 'encoder_pos_conv_groups': 16, 'encoder_num_layers': 12, 'encoder_use_attention': [True, True, True, True, True, True, True, True, True, True, True, True], 'encoder_use_feed_forward': [True, True, True, True, True, True, True, True, True, True, True, True], 'encoder_total_num_heads': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'encoder_remaining_heads': [[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]], 'encoder_num_buckets': 320, 'encoder_max_distance': 800, 'encoder_attention_dropout': 0.1, 'encoder_ff_interm_features': [3072, 3072, 3072, 3072, 3072, 3072, 3072, 3072, 3072, 3072, 3072, 3072], 'encoder_ff_interm_dropout': 0.0, 'encoder_dropout': 0.1, 'encoder_layer_norm_first': False, 'encoder_layer_drop': 0.05, 'normalize_waveform': False}
[ DEBUG : 2025-09-27 21:37:29,521 ] -   - config: {'extractor_mode': 'group_norm', 'extractor_conv_layer_config': [(512, 10, 5), (512, 3, 2), (512, 3, 2), (512, 3, 2), (512, 3, 2), (512, 2, 2), (512, 2, 2)], 'extractor_conv_bias': False, 'encoder_embed_dim': 768, 'encoder_projection_dropout': 0.1, 'encoder_pos_conv_kernel': 128, 'encoder_pos_conv_groups': 16, 'encoder_num_layers': 12, 'encoder_use_attention': [True, True, True, True, True, True, True, True, True, True, True, True], 'encoder_use_feed_forward': [True, True, True, True, True, True, True, True, True, True, True, True], 'encoder_total_num_heads': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'encoder_remaining_heads': [[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]], 'encoder_num_buckets': 320, 'encoder_max_distance': 800, 'encoder_attention_dropout': 0.1, 'encoder_ff_interm_features': [3072, 3072, 3072, 3072, 3072, 3072, 3072, 3072, 3072, 3072, 3072, 3072], 'encoder_ff_interm_dropout': 0.0, 'encoder_dropout': 0.1, 'encoder_layer_norm_first': False, 'encoder_layer_drop': 0.05, 'normalize_waveform': False}
[ DEBUG : 2025-09-27 21:37:29,521 ] -   - config: {'extractor_mode': 'group_norm', 'extractor_conv_layer_config': [(512, 10, 5), (512, 3, 2), (512, 3, 2), (512, 3, 2), (512, 3, 2), (512, 2, 2), (512, 2, 2)], 'extractor_conv_bias': False, 'encoder_embed_dim': 768, 'encoder_projection_dropout': 0.1, 'encoder_pos_conv_kernel': 128, 'encoder_pos_conv_groups': 16, 'encoder_num_layers': 12, 'encoder_use_attention': [True, True, True, True, True, True, True, True, True, True, True, True], 'encoder_use_feed_forward': [True, True, True, True, True, True, True, True, True, True, True, True], 'encoder_total_num_heads': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'encoder_remaining_heads': [[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]], 'encoder_num_buckets': 320, 'encoder_max_distance': 800, 'encoder_attention_dropout': 0.1, 'encoder_ff_interm_features': [3072, 3072, 3072, 3072, 3072, 3072, 3072, 3072, 3072, 3072, 3072, 3072], 'encoder_ff_interm_dropout': 0.0, 'encoder_dropout': 0.1, 'encoder_layer_norm_first': False, 'encoder_layer_drop': 0.05, 'normalize_waveform': False}
[ DEBUG : 2025-09-27 21:37:29,521 ] -   - config: {'extractor_mode': 'group_norm', 'extractor_conv_layer_config': [(512, 10, 5), (512, 3, 2), (512, 3, 2), (512, 3, 2), (512, 3, 2), (512, 2, 2), (512, 2, 2)], 'extractor_conv_bias': False, 'encoder_embed_dim': 768, 'encoder_projection_dropout': 0.1, 'encoder_pos_conv_kernel': 128, 'encoder_pos_conv_groups': 16, 'encoder_num_layers': 12, 'encoder_use_attention': [True, True, True, True, True, True, True, True, True, True, True, True], 'encoder_use_feed_forward': [True, True, True, True, True, True, True, True, True, True, True, True], 'encoder_total_num_heads': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'encoder_remaining_heads': [[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]], 'encoder_num_buckets': 320, 'encoder_max_distance': 800, 'encoder_attention_dropout': 0.1, 'encoder_ff_interm_features': [3072, 3072, 3072, 3072, 3072, 3072, 3072, 3072, 3072, 3072, 3072, 3072], 'encoder_ff_interm_dropout': 0.0, 'encoder_dropout': 0.1, 'encoder_layer_norm_first': False, 'encoder_layer_drop': 0.05, 'normalize_waveform': False}
[ INFO : 2025-09-27 21:37:29,521 ] - Building model.
[ DEBUG : 2025-09-27 21:37:29,521 ] -   - config: {'extractor_mode': 'group_norm', 'extractor_conv_layer_config': [(512, 10, 5), (512, 3, 2), (512, 3, 2), (512, 3, 2), (512, 3, 2), (512, 2, 2), (512, 2, 2)], 'extractor_conv_bias': False, 'encoder_embed_dim': 768, 'encoder_projection_dropout': 0.1, 'encoder_pos_conv_kernel': 128, 'encoder_pos_conv_groups': 16, 'encoder_num_layers': 12, 'encoder_use_attention': [True, True, True, True, True, True, True, True, True, True, True, True], 'encoder_use_feed_forward': [True, True, True, True, True, True, True, True, True, True, True, True], 'encoder_total_num_heads': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'encoder_remaining_heads': [[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]], 'encoder_num_buckets': 320, 'encoder_max_distance': 800, 'encoder_attention_dropout': 0.1, 'encoder_ff_interm_features': [3072, 3072, 3072, 3072, 3072, 3072, 3072, 3072, 3072, 3072, 3072, 3072], 'encoder_ff_interm_dropout': 0.0, 'encoder_dropout': 0.1, 'encoder_layer_norm_first': False, 'encoder_layer_drop': 0.05, 'normalize_waveform': False}
[ INFO : 2025-09-27 21:37:29,521 ] - Building model.
[ INFO : 2025-09-27 21:37:29,521 ] - Building model.
[ INFO : 2025-09-27 21:37:29,521 ] - Building model.
[ WARNING : 2025-09-27 21:37:29,521 ] - The model is not an instance of Wav2Vec2ForCTC or WavLMForCTC. "lm_head" module is not imported.
[ INFO : 2025-09-27 21:37:29,521 ] - Building model.
[ WARNING : 2025-09-27 21:37:29,521 ] - The model is not an instance of Wav2Vec2ForCTC or WavLMForCTC. "lm_head" module is not imported.
[ WARNING : 2025-09-27 21:37:29,521 ] - The model is not an instance of Wav2Vec2ForCTC or WavLMForCTC. "lm_head" module is not imported.
[ WARNING : 2025-09-27 21:37:29,521 ] - The model is not an instance of Wav2Vec2ForCTC or WavLMForCTC. "lm_head" module is not imported.
[ WARNING : 2025-09-27 21:37:29,521 ] - The model is not an instance of Wav2Vec2ForCTC or WavLMForCTC. "lm_head" module is not imported.
[ INFO : 2025-09-27 21:37:31,577 ] - Train model from scratch ...
[ INFO : 2025-09-27 21:37:31,637 ] - start_epoch: 1
[ INFO : 2025-09-27 21:37:31,663 ] - Train model from scratch ...
[ INFO : 2025-09-27 21:37:31,686 ] - Train model from scratch ...
[ INFO : 2025-09-27 21:37:31,688 ] - speaker_model size: 95631530
[ INFO : 2025-09-27 21:37:31,689 ] - Train model from scratch ...
[ INFO : 2025-09-27 21:37:31,725 ] - start_epoch: 1
[ INFO : 2025-09-27 21:37:31,725 ] - Train model from scratch ...
[ INFO : 2025-09-27 21:37:31,747 ] - start_epoch: 1
[ INFO : 2025-09-27 21:37:31,750 ] - SSL_BACKEND_MHFA(
[ INFO : 2025-09-27 21:37:31,750 ] -   (cmp_linear_k): Linear(in_features=768, out_features=128, bias=True)
[ INFO : 2025-09-27 21:37:31,750 ] -   (cmp_linear_v): Linear(in_features=768, out_features=128, bias=True)
[ INFO : 2025-09-27 21:37:31,751 ] -   (att_head): Linear(in_features=128, out_features=32, bias=True)
[ INFO : 2025-09-27 21:37:31,751 ] -   (pooling_fc): Linear(in_features=4096, out_features=256, bias=True)
[ INFO : 2025-09-27 21:37:31,751 ] -   (frontend): HuggingfaceFrontend(
[ INFO : 2025-09-27 21:37:31,751 ] -     (upstream): Wav2Vec2Model(
[ INFO : 2025-09-27 21:37:31,751 ] -       (feature_extractor): FeatureExtractor(
[ INFO : 2025-09-27 21:37:31,751 ] -         (conv_layers): ModuleList(
[ INFO : 2025-09-27 21:37:31,751 ] -           (0): ConvLayerBlock(
[ INFO : 2025-09-27 21:37:31,751 ] -             (layer_norm): GroupNorm(512, 512, eps=1e-05, affine=True)
[ INFO : 2025-09-27 21:37:31,751 ] -             (conv): Conv1d(1, 512, kernel_size=(10,), stride=(5,), bias=False)
[ INFO : 2025-09-27 21:37:31,751 ] -           )
[ INFO : 2025-09-27 21:37:31,751 ] -           (1-4): 4 x ConvLayerBlock(
[ INFO : 2025-09-27 21:37:31,751 ] -             (conv): Conv1d(512, 512, kernel_size=(3,), stride=(2,), bias=False)
[ INFO : 2025-09-27 21:37:31,751 ] -           )
[ INFO : 2025-09-27 21:37:31,751 ] -           (5-6): 2 x ConvLayerBlock(
[ INFO : 2025-09-27 21:37:31,751 ] -             (conv): Conv1d(512, 512, kernel_size=(2,), stride=(2,), bias=False)
[ INFO : 2025-09-27 21:37:31,751 ] -           )
[ INFO : 2025-09-27 21:37:31,752 ] -         )
[ INFO : 2025-09-27 21:37:31,752 ] -       )
[ INFO : 2025-09-27 21:37:31,752 ] -       (encoder): Encoder(
[ INFO : 2025-09-27 21:37:31,752 ] -         (feature_projection): FeatureProjection(
[ INFO : 2025-09-27 21:37:31,752 ] -           (layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
[ INFO : 2025-09-27 21:37:31,752 ] -           (projection): Linear(in_features=512, out_features=768, bias=True)
[ INFO : 2025-09-27 21:37:31,752 ] -           (dropout): Dropout(p=0.1, inplace=False)
[ INFO : 2025-09-27 21:37:31,752 ] -         )
[ INFO : 2025-09-27 21:37:31,752 ] -         (transformer): Transformer(
[ INFO : 2025-09-27 21:37:31,752 ] -           (pos_conv_embed): ConvolutionalPositionalEmbedding(
[ INFO : 2025-09-27 21:37:31,752 ] -             (conv): ParametrizedConv1d(
[ INFO : 2025-09-27 21:37:31,752 ] -               768, 768, kernel_size=(128,), stride=(1,), padding=(64,), groups=16
[ INFO : 2025-09-27 21:37:31,752 ] -               (parametrizations): ModuleDict(
[ INFO : 2025-09-27 21:37:31,752 ] -                 (weight): ParametrizationList(
[ INFO : 2025-09-27 21:37:31,752 ] -                   (0): _WeightNorm()
[ INFO : 2025-09-27 21:37:31,752 ] -                 )
[ INFO : 2025-09-27 21:37:31,753 ] -               )
[ INFO : 2025-09-27 21:37:31,753 ] -             )
[ INFO : 2025-09-27 21:37:31,753 ] -           )
[ INFO : 2025-09-27 21:37:31,753 ] -           (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
[ INFO : 2025-09-27 21:37:31,753 ] -           (dropout): Dropout(p=0.1, inplace=False)
[ INFO : 2025-09-27 21:37:31,753 ] -           (layers): ModuleList(
[ INFO : 2025-09-27 21:37:31,753 ] -             (0): EncoderLayer(
[ INFO : 2025-09-27 21:37:31,753 ] -               (attention): WavLMSelfAttention(
[ INFO : 2025-09-27 21:37:31,753 ] -                 (dropout): Dropout(p=0.1, inplace=False)
[ INFO : 2025-09-27 21:37:31,753 ] -                 (k_proj): Linear(in_features=768, out_features=768, bias=True)
[ INFO : 2025-09-27 21:37:31,753 ] -                 (v_proj): Linear(in_features=768, out_features=768, bias=True)
[ INFO : 2025-09-27 21:37:31,753 ] -                 (q_proj): Linear(in_features=768, out_features=768, bias=True)
[ INFO : 2025-09-27 21:37:31,753 ] -                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
[ INFO : 2025-09-27 21:37:31,753 ] -                 (rel_attn_embed): Embedding(320, 12)
[ INFO : 2025-09-27 21:37:31,753 ] -                 (gru_rel_pos_linear): Linear(in_features=64, out_features=8, bias=True)
[ INFO : 2025-09-27 21:37:31,753 ] -               )
[ INFO : 2025-09-27 21:37:31,753 ] -               (dropout): Dropout(p=0.1, inplace=False)
[ INFO : 2025-09-27 21:37:31,754 ] -               (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
[ INFO : 2025-09-27 21:37:31,754 ] -               (feed_forward): FeedForward(
[ INFO : 2025-09-27 21:37:31,754 ] -                 (intermediate_dense): Linear(in_features=768, out_features=3072, bias=True)
[ INFO : 2025-09-27 21:37:31,754 ] -                 (intermediate_dropout): Dropout(p=0.0, inplace=False)
[ INFO : 2025-09-27 21:37:31,754 ] -                 (output_dense): Linear(in_features=3072, out_features=768, bias=True)
[ INFO : 2025-09-27 21:37:31,754 ] -                 (output_dropout): Dropout(p=0.1, inplace=False)
[ INFO : 2025-09-27 21:37:31,754 ] -               )
[ INFO : 2025-09-27 21:37:31,754 ] -               (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
[ INFO : 2025-09-27 21:37:31,754 ] -             )
[ INFO : 2025-09-27 21:37:31,754 ] -             (1-11): 11 x EncoderLayer(
[ INFO : 2025-09-27 21:37:31,754 ] -               (attention): WavLMSelfAttention(
[ INFO : 2025-09-27 21:37:31,754 ] -                 (dropout): Dropout(p=0.1, inplace=False)
[ INFO : 2025-09-27 21:37:31,754 ] -                 (k_proj): Linear(in_features=768, out_features=768, bias=True)
[ INFO : 2025-09-27 21:37:31,754 ] -                 (v_proj): Linear(in_features=768, out_features=768, bias=True)
[ INFO : 2025-09-27 21:37:31,754 ] -                 (q_proj): Linear(in_features=768, out_features=768, bias=True)
[ INFO : 2025-09-27 21:37:31,754 ] -                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
[ INFO : 2025-09-27 21:37:31,754 ] -                 (gru_rel_pos_linear): Linear(in_features=64, out_features=8, bias=True)
[ INFO : 2025-09-27 21:37:31,755 ] -               )
[ INFO : 2025-09-27 21:37:31,755 ] -               (dropout): Dropout(p=0.1, inplace=False)
[ INFO : 2025-09-27 21:37:31,755 ] -               (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
[ INFO : 2025-09-27 21:37:31,755 ] -               (feed_forward): FeedForward(
[ INFO : 2025-09-27 21:37:31,755 ] -                 (intermediate_dense): Linear(in_features=768, out_features=3072, bias=True)
[ INFO : 2025-09-27 21:37:31,755 ] -                 (intermediate_dropout): Dropout(p=0.0, inplace=False)
[ INFO : 2025-09-27 21:37:31,755 ] -                 (output_dense): Linear(in_features=3072, out_features=768, bias=True)
[ INFO : 2025-09-27 21:37:31,755 ] -                 (output_dropout): Dropout(p=0.1, inplace=False)
[ INFO : 2025-09-27 21:37:31,755 ] -               )
[ INFO : 2025-09-27 21:37:31,755 ] -               (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
[ INFO : 2025-09-27 21:37:31,755 ] -             )
[ INFO : 2025-09-27 21:37:31,755 ] -           )
[ INFO : 2025-09-27 21:37:31,755 ] -         )
[ INFO : 2025-09-27 21:37:31,755 ] -       )
[ INFO : 2025-09-27 21:37:31,755 ] -     )
[ INFO : 2025-09-27 21:37:31,755 ] -   )
[ INFO : 2025-09-27 21:37:31,755 ] -   (projection): ArcMarginProduct_intertopk_subcenter(in_features=256, out_features=17982, scale=32.0, margin=0.0, easy_margin=False,K=3, mp=0.06, k_top=5, do_lm=False)
[ INFO : 2025-09-27 21:37:31,756 ] - )
[ INFO : 2025-09-27 21:37:31,756 ] - start_epoch: 1
[ INFO : 2025-09-27 21:37:31,774 ] - Train model from scratch ...
[ INFO : 2025-09-27 21:37:31,788 ] - start_epoch: 1
[ INFO : 2025-09-27 21:37:31,829 ] - Train model from scratch ...
[ INFO : 2025-09-27 21:37:31,838 ] - start_epoch: 1
[ INFO : 2025-09-27 21:37:31,854 ] - Converting BatchNorm2d to SyncBatchNorm...
[ INFO : 2025-09-27 21:37:31,892 ] - start_epoch: 1
[ INFO : 2025-09-27 21:37:31,899 ] - Train model from scratch ...
[ INFO : 2025-09-27 21:37:31,963 ] - start_epoch: 1
/opt/miniconda3/envs/pytorch/lib/python3.10/site-packages/torch/nn/parallel/distributed.py:2219: UserWarning: You passed find_unused_parameters=true to DistributedDataParallel, `_set_static_graph` will detect unused parameters automatically, so you do not need to set find_unused_parameters=true, just be sure these unused parameters will not change during training loop while calling `_set_static_graph`.
  warnings.warn(
/opt/miniconda3/envs/pytorch/lib/python3.10/site-packages/torch/nn/parallel/distributed.py:2219: UserWarning: You passed find_unused_parameters=true to DistributedDataParallel, `_set_static_graph` will detect unused parameters automatically, so you do not need to set find_unused_parameters=true, just be sure these unused parameters will not change during training loop while calling `_set_static_graph`.
  warnings.warn(
/opt/miniconda3/envs/pytorch/lib/python3.10/site-packages/torch/nn/parallel/distributed.py:2219: UserWarning: You passed find_unused_parameters=true to DistributedDataParallel, `_set_static_graph` will detect unused parameters automatically, so you do not need to set find_unused_parameters=true, just be sure these unused parameters will not change during training loop while calling `_set_static_graph`.
  warnings.warn(
/opt/miniconda3/envs/pytorch/lib/python3.10/site-packages/torch/nn/parallel/distributed.py:2219: UserWarning: You passed find_unused_parameters=true to DistributedDataParallel, `_set_static_graph` will detect unused parameters automatically, so you do not need to set find_unused_parameters=true, just be sure these unused parameters will not change during training loop while calling `_set_static_graph`.
  warnings.warn(
/opt/miniconda3/envs/pytorch/lib/python3.10/site-packages/torch/nn/parallel/distributed.py:2219: UserWarning: You passed find_unused_parameters=true to DistributedDataParallel, `_set_static_graph` will detect unused parameters automatically, so you do not need to set find_unused_parameters=true, just be sure these unused parameters will not change during training loop while calling `_set_static_graph`.
  warnings.warn(
/opt/miniconda3/envs/pytorch/lib/python3.10/site-packages/torch/nn/parallel/distributed.py:2219: UserWarning: You passed find_unused_parameters=true to DistributedDataParallel, `_set_static_graph` will detect unused parameters automatically, so you do not need to set find_unused_parameters=true, just be sure these unused parameters will not change during training loop while calling `_set_static_graph`.
  warnings.warn(
[ INFO : 2025-09-27 21:37:32,115 ] - <== Loss ==>
[ INFO : 2025-09-27 21:37:32,115 ] - loss criterion is: CrossEntropyLoss
[ INFO : 2025-09-27 21:37:32,116 ] - <== Optimizer ==>
[ INFO : 2025-09-27 21:37:32,116 ] - optimizer is: SGD
[ INFO : 2025-09-27 21:37:32,116 ] - <== Scheduler ==>
/opt/miniconda3/envs/pytorch/lib/python3.10/site-packages/torch/nn/parallel/distributed.py:2219: UserWarning: You passed find_unused_parameters=true to DistributedDataParallel, `_set_static_graph` will detect unused parameters automatically, so you do not need to set find_unused_parameters=true, just be sure these unused parameters will not change during training loop while calling `_set_static_graph`.
  warnings.warn(
[ INFO : 2025-09-27 21:37:32,116 ] - scheduler is: ExponentialDecrease
[ INFO : 2025-09-27 21:37:32,116 ] - <== MarginScheduler ==>
/opt/miniconda3/envs/pytorch/lib/python3.10/site-packages/torch/nn/parallel/distributed.py:2219: UserWarning: You passed find_unused_parameters=true to DistributedDataParallel, `_set_static_graph` will detect unused parameters automatically, so you do not need to set find_unused_parameters=true, just be sure these unused parameters will not change during training loop while calling `_set_static_graph`.
  warnings.warn(
[ INFO : 2025-09-27 21:37:32,124 ] - <========== Training process ==========>
[ INFO : 2025-09-27 21:37:32,124 ] - +----------+----------+----------+----------+----------+----------+
[ INFO : 2025-09-27 21:37:32,124 ] - |     Epoch|     Batch|        Lr|    Margin|      Loss|       Acc|
[ INFO : 2025-09-27 21:37:32,124 ] - +----------+----------+----------+----------+----------+----------+
[ INFO : 2025-09-27 21:47:52,350 ] - |         1|       100|   0.19091|         0|    10.176|   0.03125|
[ INFO : 2025-09-27 21:47:52,350 ] - |         1|       100|   0.19091|         0|    10.195|  0.015625|
[ INFO : 2025-09-27 21:47:52,350 ] - |         1|       100|   0.19091|         0|    10.223|  0.050781|
[ INFO : 2025-09-27 21:47:52,350 ] - |         1|       100|   0.19091|         0|    10.158|  0.042969|
[ INFO : 2025-09-27 21:47:52,350 ] - |         1|       100|   0.19091|         0|    10.213|  0.039062|
[ INFO : 2025-09-27 21:47:52,350 ] - |         1|       100|   0.19091|         0|    10.162|  0.039062|
[ INFO : 2025-09-27 21:47:52,351 ] - |         1|       100|   0.19091|         0|    10.172|  0.058594|
[ INFO : 2025-09-27 21:47:52,351 ] - |         1|       100|   0.19091|         0|    10.165|  0.039062|
[ INFO : 2025-09-27 21:54:10,118 ] - |         1|       200|   0.36963|         0|    9.4358|  0.039062|
[ INFO : 2025-09-27 21:54:10,118 ] - |         1|       200|   0.36963|         0|    9.4671|  0.037109|
[ INFO : 2025-09-27 21:54:10,118 ] - |         1|       200|   0.36963|         0|    9.4519|  0.019531|
[ INFO : 2025-09-27 21:54:10,118 ] - |         1|       200|   0.36963|         0|    9.4518|  0.027344|
[ INFO : 2025-09-27 21:54:10,118 ] - |         1|       200|   0.36963|         0|    9.4388|  0.035156|
[ INFO : 2025-09-27 21:54:10,118 ] - |         1|       200|   0.36963|         0|    9.4414|   0.03125|
[ INFO : 2025-09-27 21:54:10,118 ] - |         1|       200|   0.36963|         0|    9.4379|  0.025391|
[ INFO : 2025-09-27 21:54:10,118 ] - |         1|       200|   0.36963|         0|    9.4342|  0.035156|
[ INFO : 2025-09-27 22:00:12,132 ] - |         1|       300|   0.53495|         0|    9.2015|  0.023438|
[ INFO : 2025-09-27 22:00:12,132 ] - |         1|       300|   0.53495|         0|    9.2034|   0.02474|
[ INFO : 2025-09-27 22:00:12,132 ] - |         1|       300|   0.53495|         0|    9.1891|  0.035156|
[ INFO : 2025-09-27 22:00:12,132 ] - |         1|       300|   0.53495|         0|    9.1893|  0.020833|
[ INFO : 2025-09-27 22:00:12,132 ] - |         1|       300|   0.53495|         0|    9.1893|  0.032552|
[ INFO : 2025-09-27 22:00:12,132 ] - |         1|       300|   0.53495|         0|    9.1912|  0.032552|
[ INFO : 2025-09-27 22:00:12,132 ] - |         1|       300|   0.53495|         0|    9.1987|  0.032552|
[ INFO : 2025-09-27 22:00:12,132 ] - |         1|       300|   0.53495|         0|    9.2154|  0.035156|
[ INFO : 2025-09-27 22:06:10,341 ] - |         1|       400|   0.68761|         0|    9.0662|  0.032227|
[ INFO : 2025-09-27 22:06:10,342 ] - |         1|       400|   0.68761|         0|    9.0814|  0.027344|
[ INFO : 2025-09-27 22:06:10,342 ] - |         1|       400|   0.68761|         0|    9.0752|  0.024414|
[ INFO : 2025-09-27 22:06:10,342 ] - |         1|       400|   0.68761|         0|    9.0751|  0.027344|
[ INFO : 2025-09-27 22:06:10,342 ] - |         1|       400|   0.68761|         0|    9.0679|  0.030273|
[ INFO : 2025-09-27 22:06:10,342 ] - |         1|       400|   0.68761|         0|    9.0672|  0.025391|
[ INFO : 2025-09-27 22:06:10,342 ] - |         1|       400|   0.68761|         0|    9.0675|   0.02832|
[ INFO : 2025-09-27 22:06:10,342 ] - |         1|       400|   0.68761|         0|    9.0874|  0.030273|
[ INFO : 2025-09-27 22:12:47,601 ] - |         1|       500|   0.82832|         0|    9.0008|  0.024219|
[ INFO : 2025-09-27 22:12:47,601 ] - |         1|       500|   0.82832|         0|    8.9929|  0.030469|
[ INFO : 2025-09-27 22:12:47,601 ] - |         1|       500|   0.82832|         0|     8.995|  0.026563|
[ INFO : 2025-09-27 22:12:47,601 ] - |         1|       500|   0.82832|         0|    8.9949|  0.028125|
[ INFO : 2025-09-27 22:12:47,601 ] - |         1|       500|   0.82832|         0|    8.9996|  0.022656|
[ INFO : 2025-09-27 22:12:47,601 ] - |         1|       500|   0.82832|         0|    9.0036|  0.024219|
[ INFO : 2025-09-27 22:12:47,601 ] - |         1|       500|   0.82832|         0|    9.0101|  0.028906|
[ INFO : 2025-09-27 22:12:47,602 ] - |         1|       500|   0.82832|         0|    8.9951|  0.030469|
[ INFO : 2025-09-27 22:14:35,981 ] - |         1|       533|   0.87225|         0|    8.9764|  0.031514|
[ INFO : 2025-09-27 22:14:38,011 ] - |         1|       533|   0.87225|         0|    8.9753|  0.027117|
[ INFO : 2025-09-27 22:14:38,021 ] - |         1|       533|   0.87225|         0|     8.975|  0.030781|
[ INFO : 2025-09-27 22:14:38,027 ] - |         1|       533|   0.87225|         0|     8.977|  0.026384|
[ INFO : 2025-09-27 22:14:38,027 ] - |         1|       533|   0.87225|         0|    8.9898|  0.029315|
[ INFO : 2025-09-27 22:14:38,027 ] - |         1|       533|   0.87225|         0|    8.9826|  0.024185|
[ INFO : 2025-09-27 22:14:38,027 ] - |         1|       533|   0.87225|         0|    8.9801|  0.023452|
[ INFO : 2025-09-27 22:14:38,029 ] - |         1|       533|   0.87225|         0|    8.9868|  0.022719|
[ INFO : 2025-09-27 22:21:18,090 ] - |         2|       100|    0.9981|         0|    8.6845|  0.023438|
[ INFO : 2025-09-27 22:21:18,090 ] - |         2|       100|    0.9981|         0|    8.7075| 0.0078125|
[ INFO : 2025-09-27 22:21:18,090 ] - |         2|       100|    0.9981|         0|    8.6993|  0.019531|
[ INFO : 2025-09-27 22:21:18,090 ] - |         2|       100|    0.9981|         0|      8.69|   0.03125|
[ INFO : 2025-09-27 22:21:18,090 ] - |         2|       100|    0.9981|         0|    8.6977|  0.050781|
[ INFO : 2025-09-27 22:21:18,090 ] - |         2|       100|    0.9981|         0|    8.7019|  0.027344|
[ INFO : 2025-09-27 22:21:18,090 ] - |         2|       100|    0.9981|         0|    8.6946|  0.015625|
[ INFO : 2025-09-27 22:21:18,090 ] - |         2|       100|    0.9981|         0|    8.6887|  0.027344|
[ INFO : 2025-09-27 22:27:16,559 ] - |         2|       200|    1.1135|         0|    8.6918|  0.017578|
[ INFO : 2025-09-27 22:27:16,559 ] - |         2|       200|    1.1135|         0|    8.6937|  0.027344|
[ INFO : 2025-09-27 22:27:16,559 ] - |         2|       200|    1.1135|         0|    8.6879|  0.029297|
[ INFO : 2025-09-27 22:27:16,559 ] - |         2|       200|    1.1135|         0|    8.6922|  0.021484|
[ INFO : 2025-09-27 22:27:16,559 ] - |         2|       200|    1.1135|         0|    8.6954|  0.035156|
[ INFO : 2025-09-27 22:27:16,559 ] - |         2|       200|    1.1135|         0|    8.7019|  0.021484|
[ INFO : 2025-09-27 22:27:16,559 ] - |         2|       200|    1.1135|         0|    8.6974|  0.015625|
[ INFO : 2025-09-27 22:27:16,559 ] - |         2|       200|    1.1135|         0|    8.6938|  0.023438|
[ INFO : 2025-09-27 22:33:14,863 ] - |         2|       300|    1.2191|         0|    8.6935|   0.03125|
[ INFO : 2025-09-27 22:33:14,863 ] - |         2|       300|    1.2191|         0|     8.695|  0.016927|
[ INFO : 2025-09-27 22:33:14,863 ] - |         2|       300|    1.2191|         0|    8.6903|   0.02474|
[ INFO : 2025-09-27 22:33:14,863 ] - |         2|       300|    1.2191|         0|    8.6962|  0.029948|
[ INFO : 2025-09-27 22:33:14,863 ] - |         2|       300|    1.2191|         0|    8.6884|  0.022135|
[ INFO : 2025-09-27 22:33:14,863 ] - |         2|       300|    1.2191|         0|    8.6931|  0.026042|
[ INFO : 2025-09-27 22:33:14,863 ] - |         2|       300|    1.2191|         0|    8.6916|  0.027344|
[ INFO : 2025-09-27 22:33:14,863 ] - |         2|       300|    1.2191|         0|    8.6982|  0.015625|
[ INFO : 2025-09-27 22:39:11,031 ] - |         2|       400|    1.3154|         0|    8.6983|  0.020508|
[ INFO : 2025-09-27 22:39:11,031 ] - |         2|       400|    1.3154|         0|    8.6971|  0.029297|
[ INFO : 2025-09-27 22:39:11,031 ] - |         2|       400|    1.3154|         0|    8.6913|   0.02832|
[ INFO : 2025-09-27 22:39:11,031 ] - |         2|       400|    1.3154|         0|    8.6942|  0.016602|
[ INFO : 2025-09-27 22:39:11,031 ] - |         2|       400|    1.3154|         0|    8.6958|  0.023438|
[ INFO : 2025-09-27 22:39:11,031 ] - |         2|       400|    1.3154|         0|    8.6954|   0.02832|
[ INFO : 2025-09-27 22:39:11,031 ] - |         2|       400|    1.3154|         0|    8.6895|  0.022461|
[ INFO : 2025-09-27 22:39:11,031 ] - |         2|       400|    1.3154|         0|    8.6879|  0.023438|
[ INFO : 2025-09-27 22:45:43,912 ] - |         2|       500|     1.403|         0|    8.6954|  0.021875|
[ INFO : 2025-09-27 22:45:43,912 ] - |         2|       500|     1.403|         0|    8.6904|  0.023438|
[ INFO : 2025-09-27 22:45:43,912 ] - |         2|       500|     1.403|         0|    8.6963|  0.017188|
[ INFO : 2025-09-27 22:45:43,912 ] - |         2|       500|     1.403|         0|    8.6903|  0.021094|
[ INFO : 2025-09-27 22:45:43,912 ] - |         2|       500|     1.403|         0|    8.6935|  0.027344|
[ INFO : 2025-09-27 22:45:43,912 ] - |         2|       500|     1.403|         0|    8.6973|  0.020312|
[ INFO : 2025-09-27 22:45:43,912 ] - |         2|       500|     1.403|         0|    8.6921|  0.028906|
[ INFO : 2025-09-27 22:45:43,912 ] - |         2|       500|     1.403|         0|    8.6976|  0.029687|
[ INFO : 2025-09-27 22:47:32,994 ] - |         2|       533|      1.43|         0|    8.6904|  0.021986|
[ INFO : 2025-09-27 22:47:32,997 ] - |         2|       533|      1.43|         0|    8.6993|  0.030048|
[ INFO : 2025-09-27 22:47:33,008 ] - |         2|       533|      1.43|         0|    8.6966|  0.020521|
[ INFO : 2025-09-27 22:47:33,010 ] - |         2|       533|      1.43|         0|    8.6921|  0.028582|
[ INFO : 2025-09-27 22:47:33,012 ] - |         2|       533|      1.43|         0|    8.6968|  0.016856|
[ INFO : 2025-09-27 22:47:33,014 ] - |         2|       533|      1.43|         0|    8.6956|  0.021986|
[ INFO : 2025-09-27 22:47:33,311 ] - |         2|       533|      1.43|         0|    8.6931|  0.026384|
[ INFO : 2025-09-27 22:47:33,515 ] - |         2|       533|      1.43|         0|    8.6907|  0.022719|
Traceback (most recent call last):
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/train_pq.py", line 436, in <module>
    fire.Fire(train)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 466, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/train_pq.py", line 425, in train
    save_checkpoint(
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/wespeaker/utils/checkpoint.py", line 37, in save_checkpoint
    torch.save(state_dict, path)
  File "/opt/miniconda3/envs/pytorch/lib/python3.10/site-packages/torch/serialization.py", line 628, in save
    with _open_zipfile_writer(f) as opened_zipfile:
  File "/opt/miniconda3/envs/pytorch/lib/python3.10/site-packages/torch/serialization.py", line 502, in _open_zipfile_writer
    return container(name_or_buffer)
  File "/opt/miniconda3/envs/pytorch/lib/python3.10/site-packages/torch/serialization.py", line 473, in __init__
    super().__init__(torch._C.PyTorchFileWriter(self.name))
RuntimeError: Parent directory exp/baseline_vox2/mhfa_WavLMBasePlus_frozen/models does not exist.
[2025-09-27 22:47:45,020] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 64495 closing signal SIGTERM
[2025-09-27 22:47:45,020] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 64496 closing signal SIGTERM
[2025-09-27 22:47:45,020] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 64497 closing signal SIGTERM
[2025-09-27 22:47:45,021] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 64498 closing signal SIGTERM
[2025-09-27 22:47:45,021] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 64499 closing signal SIGTERM
[2025-09-27 22:47:45,021] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 64500 closing signal SIGTERM
[2025-09-27 22:47:45,022] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 64501 closing signal SIGTERM
[2025-09-27 22:47:45,444] torch.distributed.elastic.multiprocessing.api: [ERROR] failed (exitcode: 1) local_rank: 0 (pid: 64494) of binary: /user-software/venv/pytorch/bin/python
Traceback (most recent call last):
  File "/opt/miniconda3/envs/pytorch/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/opt/miniconda3/envs/pytorch/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/opt/miniconda3/envs/pytorch/lib/python3.10/site-packages/torch/distributed/launch.py", line 198, in <module>
    main()
  File "/opt/miniconda3/envs/pytorch/lib/python3.10/site-packages/torch/distributed/launch.py", line 194, in main
    launch(args)
  File "/opt/miniconda3/envs/pytorch/lib/python3.10/site-packages/torch/distributed/launch.py", line 179, in launch
    run(args)
  File "/opt/miniconda3/envs/pytorch/lib/python3.10/site-packages/torch/distributed/run.py", line 803, in run
    elastic_launch(
  File "/opt/miniconda3/envs/pytorch/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 135, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/opt/miniconda3/envs/pytorch/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 268, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
wespeaker/bin/train_pq.py FAILED
------------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2025-09-27_22:47:45
  host      : nid005219
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 64494)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
Traceback (most recent call last):
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/average_model.py", line 80, in <module>
    main()
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/average_model.py", line 60, in main
    assert num == len(path_list)
AssertionError
cat: 'exp/baseline_vox2/mhfa_WavLMBasePlus_frozen/embeddings/vox1/xvector_*.scp': No such file or directory
cat: 'exp/baseline_vox2/mhfa_WavLMBasePlus_frozen/embeddings/vox2_dev/xvector_*.scp': No such file or directory
/user-software/venv/pytorch/lib/python3.10/site-packages/kaldiio/__init__.py:2: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Traceback (most recent call last):
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/score.py", line 95, in <module>
    fire.Fire(main)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 466, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/score.py", line 84, in main
    mean_vec = calculate_mean_from_kaldi_vec(scp_path)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/score.py", line 35, in calculate_mean_from_kaldi_vec
    return mean_vec / vec_num
TypeError: unsupported operand type(s) for /: 'NoneType' and 'int'
/user-software/venv/pytorch/lib/python3.10/site-packages/kaldiio/__init__.py:2: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Traceback (most recent call last):
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/score.py", line 95, in <module>
    fire.Fire(main)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 466, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/score.py", line 84, in main
    mean_vec = calculate_mean_from_kaldi_vec(scp_path)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/score.py", line 35, in calculate_mean_from_kaldi_vec
    return mean_vec / vec_num
TypeError: unsupported operand type(s) for /: 'NoneType' and 'int'
/user-software/venv/pytorch/lib/python3.10/site-packages/kaldiio/__init__.py:2: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Traceback (most recent call last):
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/score.py", line 95, in <module>
    fire.Fire(main)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 466, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/score.py", line 84, in main
    mean_vec = calculate_mean_from_kaldi_vec(scp_path)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/score.py", line 35, in calculate_mean_from_kaldi_vec
    return mean_vec / vec_num
TypeError: unsupported operand type(s) for /: 'NoneType' and 'int'
/user-software/venv/pytorch/lib/python3.10/site-packages/kaldiio/__init__.py:2: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Traceback (most recent call last):
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_det.py", line 48, in <module>
    fire.Fire(main)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 466, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_det.py", line 44, in main
    compute_det(scores_file, det_file)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_det.py", line 26, in compute_det
    with open(scores_file) as readlines:
FileNotFoundError: [Errno 2] No such file or directory: 'exp/baseline_vox2/mhfa_WavLMBasePlus_frozen/scores/vox1_O_cleaned.kaldi.score'
/user-software/venv/pytorch/lib/python3.10/site-packages/kaldiio/__init__.py:2: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Traceback (most recent call last):
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_det.py", line 48, in <module>
    fire.Fire(main)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 466, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_det.py", line 44, in main
    compute_det(scores_file, det_file)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_det.py", line 26, in compute_det
    with open(scores_file) as readlines:
FileNotFoundError: [Errno 2] No such file or directory: 'exp/baseline_vox2/mhfa_WavLMBasePlus_frozen/scores/vox1_E_cleaned.kaldi.score'
/user-software/venv/pytorch/lib/python3.10/site-packages/kaldiio/__init__.py:2: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Traceback (most recent call last):
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_det.py", line 48, in <module>
    fire.Fire(main)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 466, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_det.py", line 44, in main
    compute_det(scores_file, det_file)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_det.py", line 26, in compute_det
    with open(scores_file) as readlines:
FileNotFoundError: [Errno 2] No such file or directory: 'exp/baseline_vox2/mhfa_WavLMBasePlus_frozen/scores/vox1_H_cleaned.kaldi.score'
/user-software/venv/pytorch/lib/python3.10/site-packages/kaldiio/__init__.py:2: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
  0%|          | 0/5994 [00:00<?, ?it/s]  0%|          | 0/5994 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/tools/vector_mean.py", line 66, in <module>
    compute_vector_mean(args.spk2utt, args.xvector_scp, args.spk_xvector_ark)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/tools/vector_mean.py", line 47, in compute_vector_mean
    vec = utt2embs[utt]
KeyError: 'id00012/21Uxsk56VDQ/00001.wav'
/user-software/venv/pytorch/lib/python3.10/site-packages/kaldiio/__init__.py:2: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Traceback (most recent call last):
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/score_norm.py", line 119, in <module>
    fire.Fire(main)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 466, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/score_norm.py", line 68, in main
    assert os.path.exists(
AssertionError: mean_vec file (exp/baseline_vox2/mhfa_WavLMBasePlus_frozen/embeddings/vox2_dev/mean_vec.npy) does not exist !!!
/user-software/venv/pytorch/lib/python3.10/site-packages/kaldiio/__init__.py:2: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Traceback (most recent call last):
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/score_norm.py", line 119, in <module>
    fire.Fire(main)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 466, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/score_norm.py", line 68, in main
    assert os.path.exists(
AssertionError: mean_vec file (exp/baseline_vox2/mhfa_WavLMBasePlus_frozen/embeddings/vox2_dev/mean_vec.npy) does not exist !!!
/user-software/venv/pytorch/lib/python3.10/site-packages/kaldiio/__init__.py:2: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Traceback (most recent call last):
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/score_norm.py", line 119, in <module>
    fire.Fire(main)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 466, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/score_norm.py", line 68, in main
    assert os.path.exists(
AssertionError: mean_vec file (exp/baseline_vox2/mhfa_WavLMBasePlus_frozen/embeddings/vox2_dev/mean_vec.npy) does not exist !!!
/user-software/venv/pytorch/lib/python3.10/site-packages/kaldiio/__init__.py:2: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Traceback (most recent call last):
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_det.py", line 48, in <module>
    fire.Fire(main)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 466, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_det.py", line 44, in main
    compute_det(scores_file, det_file)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_det.py", line 26, in compute_det
    with open(scores_file) as readlines:
FileNotFoundError: [Errno 2] No such file or directory: 'exp/baseline_vox2/mhfa_WavLMBasePlus_frozen/scores/vox2_dev_asnorm300_vox1_O_cleaned.kaldi.score'
/user-software/venv/pytorch/lib/python3.10/site-packages/kaldiio/__init__.py:2: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Traceback (most recent call last):
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_det.py", line 48, in <module>
    fire.Fire(main)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 466, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_det.py", line 44, in main
    compute_det(scores_file, det_file)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_det.py", line 26, in compute_det
    with open(scores_file) as readlines:
FileNotFoundError: [Errno 2] No such file or directory: 'exp/baseline_vox2/mhfa_WavLMBasePlus_frozen/scores/vox2_dev_asnorm300_vox1_E_cleaned.kaldi.score'
/user-software/venv/pytorch/lib/python3.10/site-packages/kaldiio/__init__.py:2: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Traceback (most recent call last):
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_det.py", line 48, in <module>
    fire.Fire(main)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 466, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_det.py", line 44, in main
    compute_det(scores_file, det_file)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_det.py", line 26, in compute_det
    with open(scores_file) as readlines:
FileNotFoundError: [Errno 2] No such file or directory: 'exp/baseline_vox2/mhfa_WavLMBasePlus_frozen/scores/vox2_dev_asnorm300_vox1_H_cleaned.kaldi.score'
/user-software/venv/pytorch/lib/python3.10/site-packages/kaldiio/__init__.py:2: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Traceback (most recent call last):
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/score.py", line 95, in <module>
    fire.Fire(main)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 466, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/score.py", line 84, in main
    mean_vec = calculate_mean_from_kaldi_vec(scp_path)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/score.py", line 35, in calculate_mean_from_kaldi_vec
    return mean_vec / vec_num
TypeError: unsupported operand type(s) for /: 'NoneType' and 'int'
/user-software/venv/pytorch/lib/python3.10/site-packages/kaldiio/__init__.py:2: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Traceback (most recent call last):
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/score_norm.py", line 119, in <module>
    fire.Fire(main)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 466, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/score_norm.py", line 68, in main
    assert os.path.exists(
AssertionError: mean_vec file (exp/baseline_vox2/mhfa_WavLMBasePlus_frozen/embeddings/vox2_dev/mean_vec.npy) does not exist !!!
/user-software/venv/pytorch/lib/python3.10/site-packages/kaldiio/__init__.py:2: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Traceback (most recent call last):
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/score_calibration.py", line 168, in <module>
    fire.Fire()
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 466, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/score_calibration.py", line 47, in gather_calibration_factors
    assert os.path.exists(
AssertionError: score norm file (exp/baseline_vox2/mhfa_WavLMBasePlus_frozen/scores/vox2_dev_asnorm300_vox2_cali.kaldi.score) does not exist !!!
/user-software/venv/pytorch/lib/python3.10/site-packages/kaldiio/__init__.py:2: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Traceback (most recent call last):
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/score_calibration.py", line 168, in <module>
    fire.Fire()
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 466, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/score_calibration.py", line 47, in gather_calibration_factors
    assert os.path.exists(
AssertionError: score norm file (exp/baseline_vox2/mhfa_WavLMBasePlus_frozen/scores/vox2_dev_asnorm300_vox1_O_cleaned.kaldi.score) does not exist !!!
/user-software/venv/pytorch/lib/python3.10/site-packages/kaldiio/__init__.py:2: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Traceback (most recent call last):
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/score_calibration.py", line 168, in <module>
    fire.Fire()
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 466, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/score_calibration.py", line 47, in gather_calibration_factors
    assert os.path.exists(
AssertionError: score norm file (exp/baseline_vox2/mhfa_WavLMBasePlus_frozen/scores/vox2_dev_asnorm300_vox1_E_cleaned.kaldi.score) does not exist !!!
/user-software/venv/pytorch/lib/python3.10/site-packages/kaldiio/__init__.py:2: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Traceback (most recent call last):
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/score_calibration.py", line 168, in <module>
    fire.Fire()
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 466, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/score_calibration.py", line 47, in gather_calibration_factors
    assert os.path.exists(
AssertionError: score norm file (exp/baseline_vox2/mhfa_WavLMBasePlus_frozen/scores/vox2_dev_asnorm300_vox1_H_cleaned.kaldi.score) does not exist !!!
/user-software/venv/pytorch/lib/python3.10/site-packages/kaldiio/__init__.py:2: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Traceback (most recent call last):
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/score_calibration.py", line 168, in <module>
    fire.Fire()
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 466, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/score_calibration.py", line 99, in train_calibration_model
    with open(calibration_factor_file, 'r', encoding='utf-8') as fin:
FileNotFoundError: [Errno 2] No such file or directory: 'exp/baseline_vox2/mhfa_WavLMBasePlus_frozen/scores/calibration/vox2_dev_asnorm300_vox2_cali.kaldi.calibration'
/user-software/venv/pytorch/lib/python3.10/site-packages/kaldiio/__init__.py:2: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Traceback (most recent call last):
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/score_calibration.py", line 168, in <module>
    fire.Fire()
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 466, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/score_calibration.py", line 145, in infer_calibration
    with open(calibration_factor_file, 'r', encoding='utf-8') as fin:
FileNotFoundError: [Errno 2] No such file or directory: 'exp/baseline_vox2/mhfa_WavLMBasePlus_frozen/scores/calibration/vox2_dev_asnorm300_vox1_O_cleaned.kaldi.calibration'
/user-software/venv/pytorch/lib/python3.10/site-packages/kaldiio/__init__.py:2: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Traceback (most recent call last):
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/score_calibration.py", line 168, in <module>
    fire.Fire()
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 466, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/score_calibration.py", line 145, in infer_calibration
    with open(calibration_factor_file, 'r', encoding='utf-8') as fin:
FileNotFoundError: [Errno 2] No such file or directory: 'exp/baseline_vox2/mhfa_WavLMBasePlus_frozen/scores/calibration/vox2_dev_asnorm300_vox1_E_cleaned.kaldi.calibration'
/user-software/venv/pytorch/lib/python3.10/site-packages/kaldiio/__init__.py:2: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Traceback (most recent call last):
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/score_calibration.py", line 168, in <module>
    fire.Fire()
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 466, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/score_calibration.py", line 145, in infer_calibration
    with open(calibration_factor_file, 'r', encoding='utf-8') as fin:
FileNotFoundError: [Errno 2] No such file or directory: 'exp/baseline_vox2/mhfa_WavLMBasePlus_frozen/scores/calibration/vox2_dev_asnorm300_vox1_H_cleaned.kaldi.calibration'
/user-software/venv/pytorch/lib/python3.10/site-packages/kaldiio/__init__.py:2: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Traceback (most recent call last):
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_det.py", line 48, in <module>
    fire.Fire(main)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 466, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_det.py", line 44, in main
    compute_det(scores_file, det_file)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_det.py", line 26, in compute_det
    with open(scores_file) as readlines:
FileNotFoundError: [Errno 2] No such file or directory: 'exp/baseline_vox2/mhfa_WavLMBasePlus_frozen/scores/cali_vox2_dev_asnorm300_vox1_O_cleaned.kaldi.score'
/user-software/venv/pytorch/lib/python3.10/site-packages/kaldiio/__init__.py:2: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Traceback (most recent call last):
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_det.py", line 48, in <module>
    fire.Fire(main)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 466, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_det.py", line 44, in main
    compute_det(scores_file, det_file)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_det.py", line 26, in compute_det
    with open(scores_file) as readlines:
FileNotFoundError: [Errno 2] No such file or directory: 'exp/baseline_vox2/mhfa_WavLMBasePlus_frozen/scores/cali_vox2_dev_asnorm300_vox1_E_cleaned.kaldi.score'
/user-software/venv/pytorch/lib/python3.10/site-packages/kaldiio/__init__.py:2: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Traceback (most recent call last):
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_det.py", line 48, in <module>
    fire.Fire(main)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 466, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_det.py", line 44, in main
    compute_det(scores_file, det_file)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_det.py", line 26, in compute_det
    with open(scores_file) as readlines:
FileNotFoundError: [Errno 2] No such file or directory: 'exp/baseline_vox2/mhfa_WavLMBasePlus_frozen/scores/cali_vox2_dev_asnorm300_vox1_H_cleaned.kaldi.score'
