Start training ...
run_wavlm_ori.sh: num_nodes is 1, proc_per_node is 8
Starting model download and conversion for wavlm_base_plus.
Loading model: microsoft/wavlm-base-plus
_IncompatibleKeys(missing_keys=['dummy_weight'], unexpected_keys=[])
<All keys matched successfully>
_IncompatibleKeys(missing_keys=['dummy_weight'], unexpected_keys=[])
<All keys matched successfully>
_IncompatibleKeys(missing_keys=['dummy_weight'], unexpected_keys=[])
<All keys matched successfully>
_IncompatibleKeys(missing_keys=['dummy_weight'], unexpected_keys=[])
<All keys matched successfully>
_IncompatibleKeys(missing_keys=['dummy_weight'], unexpected_keys=[])
<All keys matched successfully>
_IncompatibleKeys(missing_keys=['dummy_weight'], unexpected_keys=[])
<All keys matched successfully>
_IncompatibleKeys(missing_keys=['dummy_weight'], unexpected_keys=[])
<All keys matched successfully>
<All keys matched successfully>
_IncompatibleKeys(missing_keys=['dummy_weight'], unexpected_keys=[])
<All keys matched successfully>
<All keys matched successfully>
<All keys matched successfully>
<All keys matched successfully>
<All keys matched successfully>
<All keys matched successfully>
<All keys matched successfully>
<All keys matched successfully>
Model wavlm_base_plus already converted and valid, skipping conversion.
Enabled pruning units: set()
[wavlm_base_plus] Loaded pretrained ckpt to upstream: missing=0, unexpected=0
Do model average ...
Namespace(dst_model='exp/baseline_vox2/mhfa_WavLMBasePlus_frozen/models/avg_model.pt', src_path='exp/baseline_vox2/mhfa_WavLMBasePlus_frozen/models', num=3, min_epoch=0, max_epoch=65536)
[]
Extract embeddings ...
Embedding dir is (exp/baseline_vox2/mhfa_WavLMBasePlus_frozen/embeddings).
[INFO] Extracting embeddings for vox2_dev with 1092009 utterances...
Embedding dir is (exp/baseline_vox2/mhfa_WavLMBasePlus_frozen/embeddings).
Score ...
apply cosine scoring ...
vox1_O_cleaned.kaldi
True
Calculate mean statistics from exp/baseline_vox2/mhfa_WavLMBasePlus_frozen/embeddings/vox2_dev/xvector.scp.
vox1_E_cleaned.kaldi
True
Calculate mean statistics from exp/baseline_vox2/mhfa_WavLMBasePlus_frozen/embeddings/vox2_dev/xvector.scp.
vox1_H_cleaned.kaldi
True
Calculate mean statistics from exp/baseline_vox2/mhfa_WavLMBasePlus_frozen/embeddings/vox2_dev/xvector.scp.
compute metrics (EER/minDCF) ...
/user-software/venv/pytorch/lib/python3.10/site-packages/kaldiio/__init__.py:2: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Traceback (most recent call last):
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_metrics.py", line 59, in <module>
    fire.Fire(main)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 466, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_metrics.py", line 55, in main
    compute_metrics(scores_file, p_target, c_miss, c_fa)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_metrics.py", line 29, in compute_metrics
    with open(scores_file) as readlines:
FileNotFoundError: [Errno 2] No such file or directory: 'exp/baseline_vox2/mhfa_WavLMBasePlus_frozen/scores/vox1_O_cleaned.kaldi.score'
compute DET curve ...
/user-software/venv/pytorch/lib/python3.10/site-packages/kaldiio/__init__.py:2: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Traceback (most recent call last):
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_metrics.py", line 59, in <module>
    fire.Fire(main)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 466, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_metrics.py", line 55, in main
    compute_metrics(scores_file, p_target, c_miss, c_fa)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_metrics.py", line 29, in compute_metrics
    with open(scores_file) as readlines:
FileNotFoundError: [Errno 2] No such file or directory: 'exp/baseline_vox2/mhfa_WavLMBasePlus_frozen/scores/vox1_E_cleaned.kaldi.score'
compute DET curve ...
/user-software/venv/pytorch/lib/python3.10/site-packages/kaldiio/__init__.py:2: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Traceback (most recent call last):
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_metrics.py", line 59, in <module>
    fire.Fire(main)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 466, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_metrics.py", line 55, in main
    compute_metrics(scores_file, p_target, c_miss, c_fa)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_metrics.py", line 29, in compute_metrics
    with open(scores_file) as readlines:
FileNotFoundError: [Errno 2] No such file or directory: 'exp/baseline_vox2/mhfa_WavLMBasePlus_frozen/scores/vox1_H_cleaned.kaldi.score'
compute DET curve ...
Score norm ...
compute mean xvector
compute norm score
compute metrics
/user-software/venv/pytorch/lib/python3.10/site-packages/kaldiio/__init__.py:2: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Traceback (most recent call last):
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_metrics.py", line 59, in <module>
    fire.Fire(main)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 466, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_metrics.py", line 55, in main
    compute_metrics(scores_file, p_target, c_miss, c_fa)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_metrics.py", line 29, in compute_metrics
    with open(scores_file) as readlines:
FileNotFoundError: [Errno 2] No such file or directory: 'exp/baseline_vox2/mhfa_WavLMBasePlus_frozen/scores/vox2_dev_asnorm300_vox1_O_cleaned.kaldi.score'
/user-software/venv/pytorch/lib/python3.10/site-packages/kaldiio/__init__.py:2: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Traceback (most recent call last):
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_metrics.py", line 59, in <module>
    fire.Fire(main)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 466, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_metrics.py", line 55, in main
    compute_metrics(scores_file, p_target, c_miss, c_fa)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_metrics.py", line 29, in compute_metrics
    with open(scores_file) as readlines:
FileNotFoundError: [Errno 2] No such file or directory: 'exp/baseline_vox2/mhfa_WavLMBasePlus_frozen/scores/vox2_dev_asnorm300_vox1_E_cleaned.kaldi.score'
/user-software/venv/pytorch/lib/python3.10/site-packages/kaldiio/__init__.py:2: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Traceback (most recent call last):
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_metrics.py", line 59, in <module>
    fire.Fire(main)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 466, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_metrics.py", line 55, in main
    compute_metrics(scores_file, p_target, c_miss, c_fa)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_metrics.py", line 29, in compute_metrics
    with open(scores_file) as readlines:
FileNotFoundError: [Errno 2] No such file or directory: 'exp/baseline_vox2/mhfa_WavLMBasePlus_frozen/scores/vox2_dev_asnorm300_vox1_H_cleaned.kaldi.score'
Score calibration ...
Score calibration set
True
Calculate mean statistics from exp/baseline_vox2/mhfa_WavLMBasePlus_frozen/embeddings/vox2_dev/xvector.scp.
Prepare calibration factors
Train calibration model
Infer calibration model
compute metrics
/user-software/venv/pytorch/lib/python3.10/site-packages/kaldiio/__init__.py:2: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Traceback (most recent call last):
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_metrics.py", line 59, in <module>
    fire.Fire(main)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 466, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_metrics.py", line 55, in main
    compute_metrics(scores_file, p_target, c_miss, c_fa)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_metrics.py", line 29, in compute_metrics
    with open(scores_file) as readlines:
FileNotFoundError: [Errno 2] No such file or directory: 'exp/baseline_vox2/mhfa_WavLMBasePlus_frozen/scores/cali_vox2_dev_asnorm300_vox1_O_cleaned.kaldi.score'
/user-software/venv/pytorch/lib/python3.10/site-packages/kaldiio/__init__.py:2: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Traceback (most recent call last):
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_metrics.py", line 59, in <module>
    fire.Fire(main)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 466, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_metrics.py", line 55, in main
    compute_metrics(scores_file, p_target, c_miss, c_fa)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_metrics.py", line 29, in compute_metrics
    with open(scores_file) as readlines:
FileNotFoundError: [Errno 2] No such file or directory: 'exp/baseline_vox2/mhfa_WavLMBasePlus_frozen/scores/cali_vox2_dev_asnorm300_vox1_E_cleaned.kaldi.score'
/user-software/venv/pytorch/lib/python3.10/site-packages/kaldiio/__init__.py:2: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Traceback (most recent call last):
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_metrics.py", line 59, in <module>
    fire.Fire(main)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 466, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
  File "/user-software/venv/pytorch/lib/python3.10/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_metrics.py", line 55, in main
    compute_metrics(scores_file, p_target, c_miss, c_fa)
  File "/pfs/lustrep2/scratch/project_465002053/junyi/sv/wespeaker_dev/wespeaker_hubert/examples/voxceleb/v4_pruning/wespeaker/bin/compute_metrics.py", line 29, in compute_metrics
    with open(scores_file) as readlines:
FileNotFoundError: [Errno 2] No such file or directory: 'exp/baseline_vox2/mhfa_WavLMBasePlus_frozen/scores/cali_vox2_dev_asnorm300_vox1_H_cleaned.kaldi.score'
